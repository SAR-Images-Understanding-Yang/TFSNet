# Unsupervised Domain Adaptation for SAR Target Recognition from Simulated to Measured Data in Time, Frequency and Scattering Domains

PyTorch implementation of the paper "Unsupervised Domain Adaptation for SAR Target Recognition from Simulated to Measured Data in Time, Frequency and Scattering Domains".

# Install

Please see [INSTALL.md](./INSTALL.md)

## SAMPLE dataset Scene1

<table width="630" border="0" cellpadding="0" cellspacing="0" style='width:270.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="126" span="5" style='width:54.00pt;'/>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" width="126" style='height:14.10pt;width:54.00pt;'></td>
    <td class="xl65" width="126" style='width:54.00pt;' x:str>Simulated</td>
    <td class="xl65" width="252" colspan="2" style='width:108.00pt;border-right:none;border-bottom:none;' x:str>Measured</td>
    <td class="xl65" width="126" style='width:54.00pt;'></td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;'></td>
    <td class="xl65" x:str>training</td>
    <td class="xl65" x:str>training</td>
    <td class="xl65" x:str>testing</td>
    <td class="xl65" x:str>Total</td>
   </tr>
   <tr height="38.03" style='height:16.30pt;'>
    <td class="xl65" height="38.03" style='height:16.30pt;'></td>
    <td class="xl66" x:str>14<font class="font21">°</font><font class="font0"> to 17°</font></td>
    <td class="xl65" x:str>14° to 16°</td>
    <td class="xl65" x:str>17°</td>
    <td class="xl65"></td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>2s1</td>
    <td class="xl65" x:num>174</td>
    <td class="xl65" x:num>116</td>
    <td class="xl65" x:num>58</td>
    <td class="xl65" x:num>348</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>bmp2</td>
    <td class="xl65" x:num>107</td>
    <td class="xl65" x:num>55</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>214</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>btr70</td>
    <td class="xl65" x:num>92</td>
    <td class="xl65" x:num>43</td>
    <td class="xl65" x:num>49</td>
    <td class="xl65" x:num>184</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m1</td>
    <td class="xl65" x:num>129</td>
    <td class="xl65" x:num>78</td>
    <td class="xl65" x:num>51</td>
    <td class="xl65" x:num>258</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m2</td>
    <td class="xl65" x:num>128</td>
    <td class="xl65" x:num>75</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>256</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m35</td>
    <td class="xl65" x:num>129</td>
    <td class="xl65" x:num>76</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>258</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m548</td>
    <td class="xl65" x:num>128</td>
    <td class="xl65" x:num>75</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>256</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m60</td>
    <td class="xl65" x:num>176</td>
    <td class="xl65" x:num>116</td>
    <td class="xl65" x:num>60</td>
    <td class="xl65" x:num>352</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>t72</td>
    <td class="xl65" x:num>108</td>
    <td class="xl65" x:num>56</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>216</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>zsu23</td>
    <td class="xl65" x:num>174</td>
    <td class="xl65" x:num>116</td>
    <td class="xl65" x:num>58</td>
    <td class="xl65" x:num>348</td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table>

## SAMPLE dataset Scene2

<table width="630" border="0" cellpadding="0" cellspacing="0" style='width:270.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="126" span="5" style='width:54.00pt;'/>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" width="126" style='height:14.10pt;width:54.00pt;'></td>
    <td class="xl65" width="126" style='width:54.00pt;' x:str>Simulated</td>
    <td class="xl65" width="252" colspan="2" style='width:108.00pt;border-right:none;border-bottom:none;' x:str>Measured</td>
    <td class="xl65" width="126" style='width:54.00pt;'></td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;'></td>
    <td class="xl65" x:str>training</td>
    <td class="xl65" x:str>training</td>
    <td class="xl65" x:str>testing</td>
    <td class="xl65" x:str>Total</td>
   </tr>
   <tr height="38.03" style='height:16.30pt;'>
    <td class="xl65" height="38.03" style='height:16.30pt;'></td>
    <td class="xl66" x:str>14<font class="font21">°</font><font class="font0"> to 17°</font></td>
    <td class="xl65" x:str>16°</td>
    <td class="xl65" x:str>17°</td>
    <td class="xl65"></td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>2s1</td>
    <td class="xl65" x:num>174</td>
    <td class="xl65" x:num>50</td>
    <td class="xl65" x:num>58</td>
    <td class="xl65" x:num>282</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>bmp2</td>
    <td class="xl65" x:num>107</td>
    <td class="xl65" x:num>55</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>214</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>btr70</td>
    <td class="xl65" x:num>92</td>
    <td class="xl65" x:num>43</td>
    <td class="xl65" x:num>49</td>
    <td class="xl65" x:num>184</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m1</td>
    <td class="xl65" x:num>129</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>51</td>
    <td class="xl65" x:num>232</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m2</td>
    <td class="xl65" x:num>128</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>233</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m35</td>
    <td class="xl65" x:num>129</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>234</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m548</td>
    <td class="xl65" x:num>128</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>232</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m60</td>
    <td class="xl65" x:num>176</td>
    <td class="xl65" x:num>51</td>
    <td class="xl65" x:num>60</td>
    <td class="xl65" x:num>288</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>t72</td>
    <td class="xl65" x:num>108</td>
    <td class="xl65" x:num>56</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>216</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>zsu23</td>
    <td class="xl65" x:num>174</td>
    <td class="xl65" x:num>50</td>
    <td class="xl65" x:num>58</td>
    <td class="xl65" x:num>282</td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table>

## SAMPLE dataset Scene3

<table width="630" border="0" cellpadding="0" cellspacing="0" style='width:270.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="126" span="5" style='width:54.00pt;'/>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" width="126" style='height:14.10pt;width:54.00pt;'></td>
    <td class="xl65" width="126" style='width:54.00pt;' x:str>Simulated</td>
    <td class="xl65" width="252" colspan="2" style='width:108.00pt;border-right:none;border-bottom:none;' x:str>Measured</td>
    <td class="xl65" width="126" style='width:54.00pt;'></td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;'></td>
    <td class="xl65" x:str>training</td>
    <td class="xl65" x:str>training</td>
    <td class="xl65" x:str>testing</td>
    <td class="xl65" x:str>Total</td>
   </tr>
   <tr height="38.03" style='height:16.30pt;'>
    <td class="xl65" height="38.03" style='height:16.30pt;'></td>
    <td class="xl66" x:str>14<font class="font21">°</font><font class="font0"> to 16°</font></td>
    <td class="xl65" x:str>16°</td>
    <td class="xl65" x:str>17°</td>
    <td class="xl65"></td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>2s1</td>
    <td class="xl65" x:num>116</td>
    <td class="xl65" x:num>50</td>
    <td class="xl65" x:num>58</td>
    <td class="xl65" x:num>224</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>bmp2</td>
    <td class="xl65" x:num>55</td>
    <td class="xl65" x:num>55</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>162</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>btr70</td>
    <td class="xl65" x:num>43</td>
    <td class="xl65" x:num>43</td>
    <td class="xl65" x:num>49</td>
    <td class="xl65" x:num>135</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m1</td>
    <td class="xl65" x:num>78</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>51</td>
    <td class="xl65" x:num>181</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m2</td>
    <td class="xl65" x:num>75</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>180</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m35</td>
    <td class="xl65" x:num>76</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>181</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m548</td>
    <td class="xl65" x:num>75</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>53</td>
    <td class="xl65" x:num>179</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>m60</td>
    <td class="xl65" x:num>116</td>
    <td class="xl65" x:num>51</td>
    <td class="xl65" x:num>60</td>
    <td class="xl65" x:num>228</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>t72</td>
    <td class="xl65" x:num>56</td>
    <td class="xl65" x:num>56</td>
    <td class="xl65" x:num>52</td>
    <td class="xl65" x:num>164</td>
   </tr>
   <tr height="32.90" style='height:14.10pt;'>
    <td class="xl65" height="32.90" style='height:14.10pt;' x:str>zsu23</td>
    <td class="xl65" x:num>116</td>
    <td class="xl65" x:num>50</td>
    <td class="xl65" x:num>58</td>
    <td class="xl65" x:num>224</td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table>

## Classification models on the three Scenes of SAMPLE dataset

| Scene |       Accuracy       |      Precision      |        Recall        |          F1          |
| :----: | :------------------: | :------------------: | :------------------: | :------------------: |
| Scene1 | $ 99.33\pm 00.19$% | $ 99.40\pm 00.15$% | $ 99.33\pm 00.19$% | $ 99.35\pm 00.18$% |
| Scene2 | $ 98.89\pm 00.15$% | $ 98.98\pm 00.07$% | $ 98.89\pm 00.16$% | $ 98.88\pm 00.14$% |
| Scene3 | $ 98.33\pm 00.32$% | $ 98.44\pm 00.24$% | $ 98.26\pm 00.41$% | $ 98.26\pm 00.37$% |

# Training

```
# Experiment Scene1
python tools/train.py --config configs/Scene1/TFSNet.yaml --data_dir datasets/Scene1 --src_domain Simulation --tgt_domain Real --checkpoints configs/Scene1

# Experiment Scene2
python tools/train.py --config configs/Scene2/TFSNet.yaml --data_dir datasets/Scene2 --src_domain Simulation --tgt_domain Real --checkpoints configs/Scene2

# Experiment Scene3
python tools/train.py --config configs/Scene3/TFSNet.yaml --data_dir datasets/Scene3 --src_domain Simulation --tgt_domain Real --checkpoints configs/Scene3
```

# Testing and Visualizing

```
# Experiment Scene1
python tools/visualize_results.py --config configs/Scene1/TFSNet.yaml --data_dir datasets/Scene1 --tgt_domain Real --checkpoints configs/Scene1

# Experiment Scene2
python tools/visualize_results.py --config configs/Scene2/TFSNet.yaml --data_dir datasets/Scene2 --tgt_domain Real --checkpoints configs/Scene2

# Experiment Scene3
python tools/visualize_results.py --config configs/Scene3/TFSNet.yaml --data_dir datasets/Scene3 --tgt_domain Real --checkpoints configs/Scene3
```

# Warning

The paper is currently in the review stage, so the important codes has not been uploaded yet.





